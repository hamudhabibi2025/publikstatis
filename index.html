<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASKAB PSSI PENTAWAI</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Configure Tailwind for mobile-first design -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f7f7;
            padding-bottom: 64px; /* Space for fixed bottom navigation */
            max-width: 640px; /* Force mobile constraint for larger screens */
            margin: 0 auto;
        }

        /* Custom scrollbar for elegance */
        ::-webkit-scrollbar {
            width: 4px;
        }
        ::-webkit-scrollbar-thumb {
            background: #1e40af;
            border-radius: 10px;
        }
        
        .nav-active {
            color: #ffffff; /* White text for active icon/text */
            background-color: #1e40af; /* Blue background for active icon */
        }
    </style>
</head>
<body class="mx-auto min-h-screen">

    <!-- Konten Utama (Main Content) -->
    <div id="app-content" class="pb-4">
        <!-- Konten akan dimuat di sini oleh JavaScript -->
    </div>

    <!-- Modal Dialog untuk Berita -->
    <div id="news-modal" class="fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm z-50 hidden justify-center items-start pt-8 p-4 overflow-y-auto">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-sm overflow-hidden transform transition-all duration-300 scale-95 opacity-0" id="news-modal-content">
            <!-- Modal Header -->
            <div class="p-4 flex justify-between items-center border-b border-gray-100">
                <h3 class="text-xl font-bold text-gray-800">Detail Berita</h3>
                <button onclick="closeNewsModal()" class="text-gray-500 hover:text-gray-700 p-2 rounded-full hover:bg-gray-100 transition">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <!-- Modal Body (Diisi oleh JS) -->
            <div id="modal-body" class="p-4 text-gray-700 space-y-4">
                <!-- Data berita akan dimuat di sini -->
            </div>
        </div>
    </div>

    <!-- Navigasi Bawah Tetap (Fixed Bottom Navigation) -->
    <nav class="fixed bottom-0 left-0 right-0 max-w-sm mx-auto bg-white border-t border-gray-200 shadow-xl z-40 rounded-t-xl overflow-hidden">
        <div class="flex justify-around items-center h-16">
            <button id="nav-home" onclick="showView('home', this)" class="flex flex-col items-center justify-center flex-1 p-2 text-xs font-medium text-gray-500 hover:text-blue-700 transition duration-150">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-10v10a1 1 0 001 1h3m-6-10v8a1 1 0 01-1 1h-6a1 1 0 01-1-1v-8"></path></svg>
                Home
            </button>
            <button id="nav-klasemen" onclick="showView('klasemen', this)" class="flex flex-col items-center justify-center flex-1 p-2 text-xs font-medium text-gray-500 hover:text-blue-700 transition duration-150">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l-2 2-2-2m13-1l-2 2-2-2m5 20h-8m8-4h-8m8-4h-8m8-4h-8"></path></svg>
                Klasemen
            </button>
            <button id="nav-klub" onclick="showView('klub', this)" class="flex flex-col items-center justify-center flex-1 p-2 text-xs font-medium text-gray-500 hover:text-blue-700 transition duration-150">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.247m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18s-3.332.477-4.5 1.247" /></svg>
                Klub
            </button>
            <button id="nav-info" onclick="showView('info', this)" class="flex flex-col items-center justify-center flex-1 p-2 text-xs font-medium text-gray-500 hover:text-blue-700 transition duration-150">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                Info
            </button>
            <button id="nav-tentang" onclick="showView('tentang', this)" class="flex flex-col items-center justify-center flex-1 p-2 text-xs font-medium text-gray-500 hover:text-blue-700 transition duration-150">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 10h5m-11 5h5m-5 5h5M7 10h.01M7 15h.01M7 20h.01M3 21h18M3 5h18a2 2 0 012 2v14a2 2 0 01-2 2H3a2 2 0 01-2-2V7a2 2 0 012-2z" /></svg>
                Tentang
            </button>
        </div>
    </nav>

    <script>
        // Data dari "sheets" pengguna (dikonversi ke JavaScript Object)
        const APP_DATA = {
            "kepala_halaman": {
                "logo_pssi": "https://i.ibb.co.com/1t4P2rN5/IMG-20251112-015057.jpg",
                "Judul_kepala": "ASKAB PSSI PENTAWAI",
                "logo_askab": "https://i.ibb.co.com/TQ2hm2h/IMG-20251112-015234.jpg"
            },
            "berita": [
                {
                    "id_berita": "BRT-002",
                    "tanggal": "20/10/2025", 
                    "Judul_berita": "Launching Liga Mentawai Premier League",
                    "isi_berita": "Kegiatan peluncuran Liga Mentawai Premier League berjalan sukses. Acara dihadiri oleh seluruh manajer klub dan disaksikan oleh ratusan pendukung.",
                    "gambar_1": "https://i.ibb.co.com/HM79Rd6/IMG-20251112-015205.jpg",
                    "gambar_2": "https://i.ibb.co.com/TQ2hm2h/IMG-20251112-015234.jpg",
                    "gambar_3": "https://i.ibb.co.com/1t4P2rN5/IMG-20251112-015057.jpg"
                },
                {
                    "id_berita": "BRT-001",
                    "tanggal": "18/10/2025", 
                    "Judul_berita": "Aksi Solidaritas Pemuda Sepakbola",
                    "isi_berita": "Dalam semangat kebersamaan, para pemain muda dari berbagai klub Mentawai mengadakan aksi bersih-bersih stadion sebagai bentuk solidaritas dan kecintaan terhadap fasilitas olahraga lokal. Kegiatan ini diharapkan dapat meningkatkan kesadaran akan pentingnya menjaga kebersihan.",
                    "gambar_1": "https://i.ibb.co.com/1t4P2rN5/IMG-20251112-015057.jpg",
                    "gambar_2": "https://i.ibb.co.com/TQ2hm2h/IMG-20251112-015234.jpg",
                    "gambar_3": "https://i.ibb.co.com/HM79Rd6/IMG-20251112-015205.jpg"
                }
            ],
            "match": [
                // Future Match (MATCH-003)
                {
                    "id_match": "MATCH-003",
                    "id_kompetisi: "COMP-6231",
                    "nama_kompetisi": "MENTAWAI PREMIER LEAGUE 2025",
                    "babak_pertandingan": "Babak Fase Group Wilayah Sipora",
                    "tanggal_match": "12/01/2025", 
                    "jam": "19:00",
                    "lokasi": "lapangan desa sipora jaya",
                    "nama_klub_home": "MAICON FC",
                    "logo_klub_home": "https://i.ibb.co.com/V02rLmwm/f37a5f133a9c.jpg",
                    "goal_home": null, // Belum bertanding
                    "goal_away": null,
                    "poin_home": 0,
                    "poin_away": 0,
                    "keterangan_goal_home": "dghfdshjfs",
                    "keterangan_goal_away": "dghfhjhmjdshjfs",
                    "kartu_merah_home": 0,
                    "kartu_merah_away": 1,
                    "id_klub_away": "APM-005",
                    "nama_klub_away": "PERSIKOPA",
                    "logo_klub_away": "https://i.ibb.co.com/V02rLmwm/f37a5f133a9c.jpg",
                },
                // Past Match (MATCH-002) - Draw
                {
                    "id_match": "MATCH-002",
                    "nama_kompetisi": "MENTAWAI PREMIER LEAGUE 2025",
                    "babak_pertandingan": "Babak Fase Group Wilayah Sipora",
                    "tanggal_match": "11/10/2025", 
                    "jam": "15:30",
                    "lokasi": "lapangan desa sipora jaya",
                    "nama_klub_home": "SATRIA MUDA",
                    "logo_klub_home": "https://i.ibb.co.com/V02rLmwm/f37a5f133a9c.jpg",
                    "goal_home": 2,
                    "goal_away": 2,
                    "poin_home": 1,
                    "poin_away": 1,
                    "id_klub_away": "APM-004",
                    "nama_klub_away": "SIKABAU FC",
                    "logo_klub_away": "https://placehold.co.com/100x100/b91c1c/ffffff?text=SK",
                },
                // Past Match (MATCH-001) - Win Away
                {
                    "id_match": "MATCH-001",
                    "nama_kompetisi": "MENTAWAI PREMIER LEAGUE 2025",
                    "babak_pertandingan": "Babak Fase Group Wilayah Sipora",
                    "tanggal_match": "11/22/2025", 
                    "jam": "15:30",
                    "lokasi": "lapangan desa sipora jaya",
                    "nama_klub_home": "MAICON FC",
                    "logo_klub_home": "https://i.ibb.co.com/V02rLmwm/f37a5f133a9c.jpg",
                    "goal_home": 1,
                    "goal_away": 3,
                    "poin_home": 0,
                    "poin_away": 3,
                    "id_klub_away": "APM-001",
                    "nama_klub_away": "HARIMAU PUTIH",
                    "logo_klub_away": "https://i.ibb.co.com/V02rLmwm/f37a5f133a9c.jpg",
                }
            ],
            "klub_kami": {
                "id_klub": "APM-001",
                "nama_klub": "MAICON FC",
                "nama_manajer": "AFRI SURYANTO S,AP",
                "no_telp_klub": "82283364484",
                "alamat_klub": "Desa Sido Makmur, sipora utara",
                "logo_klub": "https://i.ibb.co.com/V02rLmwm/f37a5f133a9c.jpg"
            },
            "pemain": [
                {
                    "id_pemain": "1111111111111111",
                    "id_klub": "APM-001",
                    "nama_pemain": "Joko Susilo",
                    "tanggal_lahir": "2018-10-22",
                    "no_punggung": "43",
                    "posisi": "Kiper",
                    "nama_punggung": "J. SUSILO",
                    "pas_photo_pemain": "https://i.ibb.co.com/V02rLmwm/f37a5f133a9c.jpg"
                },
                {
                    "id_pemain": "2222222222222222",
                    "id_klub": "APM-001",
                    "nama_pemain": "Rima",
                    "tanggal_lahir": "2000-05-15",
                    "no_punggung": "10",
                    "posisi": "Penyerang",
                    "nama_punggung": "RIMA78",
                    "pas_photo_pemain": "https://i.ibb.co.com/Vc0tD99W/1d61fd9785fb.png"
                }
            ],
            "official": [
                {
                    "id_official": "1111111111111111",
                    "id_klub": "APM-001",
                    "nama_official": "YASMIN",
                    "tanggal_lahir": "2018-10-22",
                    "jabatan": "Pelatih",
                    "pas_photo_official": "https://i.ibb.co.com/Vc0tD99W/1d61fd9785fb.png"
                }
            ],
            "kompetisi": {
                "id_kompetisi": "COMP-6231",
                "nama_kompetisi": "MENTAWAI PREMIER LEAGUE 2025",
                "umur_maksimal": "80",
                "tanggal_awal_pendaftaran": "2025-11-17",
                "tanggal_akhir_pendaftaran": "2025-12-01",
                "url_logo_liga": "https://i.ibb.co.com/whSSR80B/b875b5043f80.png",
                "deskripsi": "KOMPETISI LIGA ASKAB MENTAWAI"
            },
            "slide": [
                { "banner_1": "https://i.ibb.co.com/7xZwq739/IMG-20251112-004726.jpg" },
                { "banner_2": "https://i.ibb.co.com/Rkgtqd8L/1762812029886.jpg" },
                { "banner_3": "https://i.ibb.co.com/23z5JLwp/1762812023240.jpg" }
            ],
            "tentang": {
                "nama_organisasi": "ASOSIASI KABUPATE PSSI KEPULAUAN MENTAWAI",
                "tanggal_berdiri": "03-11-2020",
                "visi": "hgsfhdsfsj",
                "misi": "fgdgs",
                "ketua": "H. Safawi M.Phil",
                "wakil_ketua": "Syahroni Wardoyo S.Sos",
                "sekretaris": "Rinaldi Kaslan S.Pd",
                "bendahara": "Eranita Matondang S.E",
                "humas": "Demian Zega S.sos",
                "media": "Ardian Humaiza S.Kom"
            },
            "login_admin": "https://facebook.com"
        };
        
        let currentView = 'home';
        let slideInterval;
        let countdownInterval;

        // --- UTILITY FUNCTIONS ---

        // Helper untuk menangani error gambar (fast image loading requirement)
        const handleErrorImage = (img) => {
            img.onerror = null; // Menghindari loop tak terbatas
            img.src = "https://placehold.co/40x40/cccccc/333333?text=Logo";
        }
        
        // Helper untuk format tanggal DD/MM/YYYY menjadi objek Date
        const parseDate = (dateStr) => {
            if (!dateStr) return null;
            const parts = dateStr.split('/');
            // Date(Year, Month(0-11), Day)
            return new Date(parts[2], parts[0] - 1, parts[1]); 
        }

        // Helper untuk memotong teks
        const truncateText = (text, wordCount) => {
            const words = text.split(/\s+/);
            if (words.length > wordCount) {
                return words.slice(0, wordCount).join(' ') + '...';
            }
            return text;
        }

        // --- HEADER COMPONENT ---

        function renderHeader(title) {
            const headerData = APP_DATA.kepala_halaman;
            return `
                <div class="fixed top-0 left-0 right-0 max-w-sm mx-auto bg-white shadow-md z-30 p-3 rounded-b-xl border-b border-gray-100">
                    <div class="flex items-center justify-between">
                        <!-- Logo PSSI (Kiri) -->
                        <img src="${headerData.logo_pssi}" 
                             onerror="handleErrorImage(this)"
                             alt="Logo PSSI" class="h-10 w-10 object-contain rounded-full border border-gray-200 p-0.5">
                        
                        <!-- Judul Kepala (Tengah) -->
                        <h1 class="text-base font-bold text-center text-blue-800 uppercase tracking-wider mx-2 flex-1 truncate">
                            ${headerData.Judul_kepala}
                        </h1>
                        
                        <!-- Logo ASKAB (Kanan) -->
                        <img src="${headerData.logo_askab}" 
                             onerror="handleErrorImage(this)"
                             alt="Logo Askab" class="h-10 w-10 object-contain rounded-full border border-gray-200 p-0.5">
                    </div>
                </div>
                <div class="pt-16"></div> <!-- Padding untuk fixed header -->
            `;
        }

        // --- HOME VIEW LOGIC ---

        function renderHome() {
            // Sortir berita berdasarkan tanggal terbaru (asumsi DD/MM/YYYY)
            const sortedBerita = [...APP_DATA.berita].sort((a, b) => {
                const dateA = parseDate(a.tanggal);
                const dateB = parseDate(b.tanggal);
                return dateB - dateA; // Terbaru (B) lebih dulu dari Terlama (A)
            });

            const newsHtml = renderNewsList(sortedBerita);

            return `
                ${renderHeader('Home')}
                <div class="p-4 space-y-4">
                    <!-- Kolom Pencarian -->
                    <div class="relative">
                        <input type="text" id="news-search" oninput="filterNews(this.value)" placeholder="Cari berita atau judul..." 
                               class="w-full p-3 pl-10 border border-gray-300 rounded-xl focus:ring-blue-500 focus:border-blue-500 text-sm shadow-sm transition">
                        <svg class="absolute left-3 top-3.5 h-4 w-4 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
                    </div>

                    <!-- Slide Otomatis (Carousel) -->
                    <div id="slide-container" class="relative w-full overflow-hidden rounded-xl shadow-lg h-40 bg-gray-200">
                        <div id="image-slider" class="flex transition-transform duration-500 ease-in-out h-full">
                            <!-- Slider images will be injected here -->
                        </div>
                        <div id="slide-dots" class="absolute bottom-2 left-0 right-0 flex justify-center space-x-2"></div>
                    </div>

                    <!-- Ringkasan Berita -->
                    <h2 class="text-lg font-bold text-gray-800 mt-6 border-b pb-2 border-blue-100">Berita Terbaru</h2>
                    <div id="news-list" class="space-y-3">
                        ${newsHtml}
                    </div>
                </div>
            `;
        }
        
        function renderSlider() {
            const slides = APP_DATA.slide.map(s => Object.values(s)[0]);
            const sliderContainer = document.getElementById('image-slider');
            const dotsContainer = document.getElementById('slide-dots');
            if (!sliderContainer || !dotsContainer) return;
            
            sliderContainer.innerHTML = slides.map((url, index) => `
                <div class="w-full flex-shrink-0 h-full">
                    <img src="${url}" 
                         onerror="handleErrorImage(this)"
                         alt="Banner ${index + 1}" class="w-full h-full object-cover">
                </div>
            `).join('');

            dotsContainer.innerHTML = slides.map((_, index) => `
                <span data-index="${index}" class="dot h-2 w-2 bg-white bg-opacity-50 rounded-full transition cursor-pointer" onclick="goToSlide(${index})"></span>
            `).join('');

            // Inisialisasi slide pertama
            updateSlide(0);
        }

        let currentSlideIndex = 0;
        const slidesCount = APP_DATA.slide.length;

        function updateSlide(index) {
            const slider = document.getElementById('image-slider');
            const dots = document.querySelectorAll('#slide-dots .dot');
            if (!slider || dots.length === 0) return;

            currentSlideIndex = index;
            slider.style.transform = `translateX(-${currentSlideIndex * 100}%)`;

            dots.forEach((dot, i) => {
                dot.classList.remove('bg-opacity-100', 'bg-blue-600');
                dot.classList.add('bg-opacity-50', 'bg-white');
                if (i === currentSlideIndex) {
                    dot.classList.add('bg-opacity-100', 'bg-blue-600');
                }
            });
        }

        function nextSlide() {
            currentSlideIndex = (currentSlideIndex + 1) % slidesCount;
            updateSlide(currentSlideIndex);
        }

        function goToSlide(index) {
            clearInterval(slideInterval);
            updateSlide(index);
            slideInterval = setInterval(nextSlide, 2000);
        }

        function startSlider() {
            if (slideInterval) clearInterval(slideInterval);
            slideInterval = setInterval(nextSlide, 2000);
            renderSlider();
        }
        
        function stopSlider() {
            if (slideInterval) clearInterval(slideInterval);
        }

        function renderNewsList(newsArray) {
            if (newsArray.length === 0) {
                return `<p class="text-center text-gray-500 py-8">Tidak ada berita yang ditemukan.</p>`;
            }
            return newsArray.map(news => `
                <div class="flex bg-white rounded-xl shadow-md overflow-hidden cursor-pointer hover:shadow-lg transition duration-300" onclick="openNewsModal('${news.id_berita}')">
                    <!-- Gambar -->
                    <div class="w-2/5 flex-shrink-0">
                        <img src="${news.gambar_1}" 
                             onerror="handleErrorImage(this)"
                             alt="${news.Judul_berita}" class="w-full h-28 object-cover">
                    </div>
                    <!-- Konten -->
                    <div class="p-3 w-3/5">
                        <p class="text-xs text-blue-600 font-semibold mb-1">${news.tanggal}</p>
                        <h3 class="text-sm font-bold text-gray-800 line-clamp-2 mb-1">${news.Judul_berita}</h3>
                        <p class="text-xs text-gray-600 line-clamp-3">${truncateText(news.isi_berita, 20)}</p>
                    </div>
                </div>
            `).join('');
        }
        
        function filterNews(searchTerm) {
            const term = searchTerm.toLowerCase();
            const filtered = APP_DATA.berita.filter(news => 
                news.Judul_berita.toLowerCase().includes(term) || 
                news.isi_berita.toLowerCase().includes(term)
            );
            document.getElementById('news-list').innerHTML = renderNewsList(filtered);
        }

        function openNewsModal(id) {
            const news = APP_DATA.berita.find(n => n.id_berita === id);
            if (!news) return;

            const modalBody = document.getElementById('modal-body');
            modalBody.innerHTML = `
                <img src="${news.gambar_1}" 
                     onerror="handleErrorImage(this)"
                     alt="${news.Judul_berita}" class="w-full h-48 object-cover rounded-lg mb-3">
                <p class="text-xs text-blue-600 font-semibold">${news.tanggal}</p>
                <h4 class="text-xl font-extrabold text-gray-900 mb-3">${news.Judul_berita}</h4>
                <p class="text-sm text-gray-700 whitespace-pre-wrap">${news.isi_berita}</p>
                <div class="flex flex-wrap gap-2 mt-4">
                    <img src="${news.gambar_2}" onerror="handleErrorImage(this)" alt="Gambar Pendukung 2" class="h-20 w-auto object-cover rounded-lg">
                    <img src="${news.gambar_3}" onerror="handleErrorImage(this)" alt="Gambar Pendukung 3" class="h-20 w-auto object-cover rounded-lg">
                </div>
            `;

            const modal = document.getElementById('news-modal');
            const modalContent = document.getElementById('news-modal-content');

            modal.classList.remove('hidden');
            modal.classList.add('flex');
            
            // Animasi masuk
            setTimeout(() => {
                modalContent.classList.remove('scale-95', 'opacity-0');
                modalContent.classList.add('scale-100', 'opacity-100');
            }, 50);
        }

        function closeNewsModal() {
            const modal = document.getElementById('news-modal');
            const modalContent = document.getElementById('news-modal-content');

            // Animasi keluar
            modalContent.classList.remove('scale-100', 'opacity-100');
            modalContent.classList.add('scale-95', 'opacity-0');

            setTimeout(() => {
                modal.classList.add('hidden');
                modal.classList.remove('flex');
                document.getElementById('modal-body').innerHTML = ''; // Clear content
            }, 300);
        }

        // --- KLASEMEN VIEW LOGIC ---

        function calculateStandings() {
            const standings = {};
            
            // 1. Ambil semua klub unik dari match data
            const uniqueClubs = new Set();
            APP_DATA.match.forEach(m => {
                uniqueClubs.add(m.nama_klub_home);
                uniqueClubs.add(m.nama_klub_away);
            });

            // 2. Inisialisasi Standings
            uniqueClubs.forEach(clubName => {
                // Find a match to get the logo (simplification)
                const clubLogo = APP_DATA.match.find(m => m.nama_klub_home === clubName)?.logo_klub_home ||
                                 APP_DATA.match.find(m => m.nama_klub_away === clubName)?.logo_klub_away ||
                                 'https://placehold.co/40x40/cccccc/333333?text=Logo';
                                 
                standings[clubName] = {
                    name: clubName,
                    logo: clubLogo,
                    P: 0, // Main
                    W: 0, // Menang
                    D: 0, // Seri
                    L: 0, // Kalah
                    GF: 0, // Gol Memasukkan
                    GA: 0, // Gol Kebobolan
                    Pts: 0, // Poin
                };
            });

            // 3. Proses Hasil Pertandingan (Hanya yang sudah selesai)
            APP_DATA.match.filter(m => m.goal_home !== null && m.goal_away !== null).forEach(m => {
                const home = standings[m.nama_klub_home];
                const away = standings[m.nama_klub_away];

                if (!home || !away) return; // Skip if club data is missing

                // Pertandingan yang dimainkan (P)
                home.P++;
                away.P++;

                // Gol Memasukkan (GF) & Gol Kebobolan (GA)
                home.GF += m.goal_home;
                home.GA += m.goal_away;
                away.GF += m.goal_away;
                away.GA += m.goal_home;

                // Hasil & Poin
                if (m.goal_home > m.goal_away) {
                    // Home Win
                    home.W++;
                    home.Pts += 3;
                    away.L++;
                } else if (m.goal_home < m.goal_away) {
                    // Away Win
                    away.W++;
                    away.Pts += 3;
                    home.L++;
                } else {
                    // Draw
                    home.D++;
                    away.D++;
                    home.Pts += 1;
                    away.Pts += 1;
                }
            });

            // 4. Hitung Selisih Gol (GD) dan Sortir
            const finalStandings = Object.values(standings).map(club => ({
                ...club,
                GD: club.GF - club.GA
            }));

            // Sortir: Poin (desc) > Selisih Gol (desc) > Gol Memasukkan (desc) > Nama Klub (asc)
            finalStandings.sort((a, b) => {
                if (b.Pts !== a.Pts) return b.Pts - a.Pts;
                if (b.GD !== a.GD) return b.GD - a.GD;
                if (b.GF !== a.GF) return b.GF - a.GF;
                return a.name.localeCompare(b.name);
            });

            return finalStandings;
        }

        function renderStandingsTable(standings) {
            return `
                <div class="overflow-x-auto shadow-xl rounded-xl">
                    <table class="min-w-full bg-white text-xs">
                        <thead class="bg-blue-600 text-white sticky top-0">
                            <tr>
                                <th class="p-2 w-8 text-left rounded-tl-xl">#</th>
                                <th class="p-2 text-left">Klub</th>
                                <th class="p-2">P</th>
                                <th class="p-2">W</th>
                                <th class="p-2">D</th>
                                <th class="p-2">L</th>
                                <th class="p-2">GF</th>
                                <th class="p-2">GA</th>
                                <th class="p-2 rounded-tr-xl font-extrabold text-sm">PTS</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${standings.map((club, index) => `
                                <tr class="${index % 2 === 0 ? 'bg-gray-50' : 'bg-white'} border-b border-gray-100 hover:bg-blue-50 transition duration-150">
                                    <td class="p-2 font-bold text-gray-700">${index + 1}</td>
                                    <td class="p-2 text-left flex items-center">
                                        <img src="${club.logo}" onerror="handleErrorImage(this)" alt="Logo ${club.name}" class="h-6 w-6 object-contain rounded-full mr-1">
                                        <span class="font-semibold text-gray-800 truncate">${club.name}</span>
                                    </td>
                                    <td class="p-2 text-center text-gray-600">${club.P}</td>
                                    <td class="p-2 text-center text-green-600 font-medium">${club.W}</td>
                                    <td class="p-2 text-center text-gray-500 font-medium">${club.D}</td>
                                    <td class="p-2 text-center text-red-600 font-medium">${club.L}</td>
                                    <td class="p-2 text-center text-gray-700">${club.GF}</td>
                                    <td class="p-2 text-center text-gray-700">${club.GA}</td>
                                    <td class="p-2 text-center font-extrabold text-base text-blue-700">${club.Pts}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        }
        
        function renderKlasemen() {
            // Hentikan interval hitung mundur sebelumnya jika ada
            if (countdownInterval) clearInterval(countdownInterval);

            const standings = calculateStandings();
            const competitionName = APP_DATA.kompetisi.nama_kompetisi || 'Nama Kompetisi';

            // Filter match data untuk pencarian
            const matchHtml = renderMatchList(APP_DATA.match);

            return `
                ${renderHeader('Klasemen')}
                <div class="p-4 space-y-4">
                    <!-- Kolom Pencarian -->
                    <div class="relative mb-6">
                        <input type="text" id="match-search" oninput="filterMatches(this.value)" placeholder="Cari pertandingan atau klub..." 
                               class="w-full p-3 pl-10 border border-gray-300 rounded-xl focus:ring-blue-500 focus:border-blue-500 text-sm shadow-sm transition">
                        <svg class="absolute left-3 top-3.5 h-4 w-4 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
                    </div>

                    <!-- Ringkasan Kompetisi & Klasemen -->
                    <div class="bg-white p-4 rounded-xl shadow-lg border-t-4 border-blue-600">
                        <h2 class="text-xl font-extrabold text-blue-700 mb-2">${competitionName}</h2>
                        <p class="text-xs text-gray-500 mb-4">${APP_DATA.kompetisi.deskripsi}</p>
                        <h3 class="text-lg font-bold text-gray-800 border-b pb-2 mb-3">Tabel Klasemen</h3>
                        ${renderStandingsTable(standings)}
                    </div>
                    
                    <!-- Daftar Pertandingan -->
                    <h2 class="text-lg font-bold text-gray-800 pt-4 border-b pb-2 border-blue-100">Jadwal & Hasil Pertandingan</h2>
                    <div id="match-list" class="space-y-3">
                        ${matchHtml}
                    </div>
                </div>
            `;
        }
        
        function filterMatches(searchTerm) {
            const term = searchTerm.toLowerCase();
            const filtered = APP_DATA.match.filter(match => 
                match.nama_klub_home.toLowerCase().includes(term) || 
                match.nama_klub_away.toLowerCase().includes(term) ||
                match.babak_pertandingan.toLowerCase().includes(term)
            );
            document.getElementById('match-list').innerHTML = renderMatchList(filtered);
            // Re-start countdown for filtered view
            startCountdown();
        }

        function renderMatchList(matches) {
            if (matches.length === 0) {
                return `<p class="text-center text-gray-500 py-8">Tidak ada pertandingan yang ditemukan.</p>`;
            }
            return matches.map(match => {
                const isPastMatch = match.goal_home !== null && match.goal_away !== null;
                const matchDateTime = new Date(match.tanggal_match + ' ' + match.jam);
                const isLive = !isPastMatch && matchDateTime < new Date() && matchDateTime > new Date(Date.now() - 2 * 60 * 60 * 1000); // Live if past but scores null (simple logic)
                
                let resultContent;
                if (isPastMatch) {
                    // Hasil Pertandingan (Past Match)
                    const homeWin = match.goal_home > match.goal_away;
                    const awayWin = match.goal_away > match.goal_home;
                    const draw = match.goal_home === match.goal_away;
                    
                    resultContent = `
                        <div class="flex flex-col items-center justify-center h-full">
                            <span class="text-xl font-extrabold ${homeWin ? 'text-green-600' : draw ? 'text-gray-600' : 'text-red-600'}">${match.goal_home}</span>
                            <span class="text-xs text-gray-500">FT</span>
                        </div>
                        <div class="flex flex-col items-center justify-center h-full">
                            <span class="text-xl font-extrabold ${awayWin ? 'text-green-600' : draw ? 'text-gray-600' : 'text-red-600'}">${match.goal_away}</span>
                            <span class="text-xs text-gray-500">FT</span>
                        </div>
                    `;
                } else {
                    // Hitung Mundur (Future Match)
                    const matchTimeStr = `${match.tanggal_match} ${match.jam}`;
                    
                    resultContent = `
                        <div class="col-span-2 flex flex-col items-center justify-center p-2 space-y-1">
                            <span class="text-xs font-semibold text-gray-500">Kick Off: ${match.jam} WIB</span>
                            <div id="countdown-${match.id_match}" data-match-time="${matchTimeStr}" class="text-sm font-extrabold text-red-600">
                                ... LOADING ...
                            </div>
                        </div>
                    `;
                }

                return `
                    <div class="bg-white rounded-xl shadow-lg p-3 space-y-2 border-t-4 border-blue-400">
                        <div class="flex justify-between items-center text-xs text-gray-500 font-medium border-b pb-2 mb-2">
                            <span>${match.babak_pertandingan}</span>
                            <span>${match.tanggal_match}</span>
                        </div>
                        <div class="grid grid-cols-5 gap-1 items-center text-center">
                            <!-- Home Team -->
                            <div class="col-span-2 flex flex-col items-center space-y-1">
                                <img src="${match.logo_klub_home}" onerror="handleErrorImage(this)" alt="Logo ${match.nama_klub_home}" class="h-10 w-10 object-contain">
                                <span class="text-xs font-bold text-gray-800 truncate w-full px-1">${match.nama_klub_home}</span>
                            </div>
                            
                            <!-- Score/Countdown -->
                            ${isPastMatch ? `
                                <div class="col-span-1 grid grid-cols-2 gap-1 bg-gray-100 rounded-lg p-1">
                                    ${resultContent}
                                </div>
                            ` : `
                                <div class="col-span-3">
                                    ${resultContent}
                                </div>
                            `}
                            
                            <!-- Away Team -->
                            <div class="col-span-2 flex flex-col items-center space-y-1">
                                <img src="${match.logo_klub_away}" onerror="handleErrorImage(this)" alt="Logo ${match.nama_klub_away}" class="h-10 w-10 object-contain">
                                <span class="text-xs font-bold text-gray-800 truncate w-full px-1">${match.nama_klub_away}</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function startCountdown() {
            if (countdownInterval) clearInterval(countdownInterval);
            
            const updateCountdown = () => {
                const countdownElements = document.querySelectorAll('[id^="countdown-"]');
                const now = new Date().getTime();

                countdownElements.forEach(el => {
                    const matchTime = new Date(el.dataset.matchTime).getTime();
                    const distance = matchTime - now;

                    if (distance < 0) {
                        el.innerHTML = `<span class="text-gray-500">SUDAH BERLANGSUNG</span>`;
                        return;
                    }

                    const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((distance % (1000 * 60)) / 1000);

                    el.innerHTML = `${days}H ${hours}J ${minutes}M ${seconds}D`;
                });
            };

            updateCountdown(); // Update immediately
            countdownInterval = setInterval(updateCountdown, 1000); // Update every second
        }

        // --- KLUB VIEW LOGIC ---
        function renderKlub() {
            const klub = APP_DATA.klub_kami;
            const pemain = APP_DATA.pemain;
            const official = APP_DATA.official;

            return `
                ${renderHeader('Klub Kami')}
                <div class="p-4 space-y-6">
                    <div class="bg-white p-6 rounded-xl shadow-lg text-center border-t-4 border-blue-600">
                        <img src="${klub.logo_klub}" onerror="handleErrorImage(this)" alt="Logo ${klub.nama_klub}" class="h-24 w-24 object-contain rounded-full mx-auto mb-3 border-2 border-gray-200 p-1">
                        <h2 class="text-2xl font-extrabold text-blue-700">${klub.nama_klub}</h2>
                        <p class="text-sm text-gray-500 mb-4">${klub.alamat_klub}</p>
                        
                        <div class="bg-gray-100 p-4 rounded-lg text-left text-sm space-y-1">
                            <p><span class="font-semibold text-gray-700">Manajer:</span> ${klub.nama_manajer}</p>
                            <p><span class="font-semibold text-gray-700">Telp:</span> ${klub.no_telp_klub}</p>
                        </div>
                    </div>

                    <h3 class="text-lg font-bold text-gray-800 border-b pb-2 mb-3">Daftar Pemain</h3>
                    <div class="grid grid-cols-2 gap-3">
                        ${pemain.map(p => `
                            <div class="bg-white rounded-xl shadow-md p-3 text-center transition hover:shadow-lg">
                                <img src="${p.pas_photo_pemain}" onerror="handleErrorImage(this)" alt="Foto ${p.nama_pemain}" class="h-16 w-16 object-cover rounded-full mx-auto mb-2 border border-blue-300">
                                <span class="text-sm font-bold text-gray-800 block truncate">${p.nama_pemain}</span>
                                <span class="text-xs text-gray-500 block">#${p.no_punggung} - ${p.posisi}</span>
                            </div>
                        `).join('')}
                    </div>

                    <h3 class="text-lg font-bold text-gray-800 border-b pb-2 mb-3 pt-4">Staf Official</h3>
                    <div class="grid grid-cols-2 gap-3">
                        ${official.map(o => `
                            <div class="bg-white rounded-xl shadow-md p-3 text-center transition hover:shadow-lg">
                                <img src="${o.pas_photo_official}" onerror="handleErrorImage(this)" alt="Foto ${o.nama_official}" class="h-16 w-16 object-cover rounded-full mx-auto mb-2 border border-blue-300">
                                <span class="text-sm font-bold text-gray-800 block truncate">${o.nama_official}</span>
                                <span class="text-xs text-blue-600 font-semibold block">${o.jabatan}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // --- INFO VIEW LOGIC ---
        function renderInfo() {
            // Menggunakan data berita yang sudah diurutkan (atau data lain jika ada)
            const sortedBerita = [...APP_DATA.berita].sort((a, b) => parseDate(b.tanggal) - parseDate(a.tanggal));

            return `
                ${renderHeader('Informasi')}
                <div class="p-4 space-y-4">
                    <h2 class="text-xl font-extrabold text-gray-800 border-b pb-2">Semua Berita & Info</h2>
                    <div class="space-y-3">
                        ${renderNewsList(sortedBerita)}
                    </div>
                    <div class="text-center p-4">
                        <a href="${APP_DATA.login_admin}" target="_blank" class="text-blue-600 hover:text-blue-800 text-sm font-semibold">Login Admin (Eksternal Link)</a>
                    </div>
                </div>
            `;
        }

        // --- TENTANG VIEW LOGIC ---
        function renderTentang() {
            const t = APP_DATA.tentang;
            return `
                ${renderHeader('Tentang Kami')}
                <div class="p-4 space-y-6">
                    <div class="bg-white p-6 rounded-xl shadow-lg border-t-4 border-blue-600">
                        <h2 class="text-xl font-extrabold text-blue-700 mb-3">${t.nama_organisasi}</h2>
                        <p class="text-sm text-gray-500 mb-4">Berdiri sejak: ${t.tanggal_berdiri}</p>
                        
                        <div class="space-y-4 text-sm">
                            <div class="p-3 bg-blue-50 rounded-lg">
                                <h3 class="font-bold text-blue-800 mb-1">Visi</h3>
                                <p class="text-gray-700">${t.visi}</p>
                            </div>
                            <div class="p-3 bg-blue-50 rounded-lg">
                                <h3 class="font-bold text-blue-800 mb-1">Misi</h3>
                                <p class="text-gray-700">${t.misi}</p>
                            </div>
                        </div>
                    </div>
                    
                    <h3 class="text-lg font-bold text-gray-800 border-b pb-2 mb-3">Struktur Organisasi</h3>
                    <div class="bg-white p-4 rounded-xl shadow-lg">
                        <ul class="space-y-2 text-sm">
                            <li class="flex justify-between border-b pb-1"><span class="font-semibold">Ketua:</span> <span class="text-gray-600">${t.ketua}</span></li>
                            <li class="flex justify-between border-b pb-1"><span class="font-semibold">Wakil Ketua:</span> <span class="text-gray-600">${t.wakil_ketua}</span></li>
                            <li class="flex justify-between border-b pb-1"><span class="font-semibold">Sekretaris:</span> <span class="text-gray-600">${t.sekretaris}</span></li>
                            <li class="flex justify-between border-b pb-1"><span class="font-semibold">Bendahara:</span> <span class="text-gray-600">${t.bendahara}</span></li>
                            <li class="flex justify-between border-b pb-1"><span class="font-semibold">Humas:</span> <span class="text-gray-600">${t.humas}</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Media:</span> <span class="text-gray-600">${t.media}</span></li>
                        </ul>
                    </div>
                </div>
            `;
        }


        // --- MAIN APPLICATION LOGIC ---
        
        function showView(viewName, element) {
            currentView = viewName;
            const appContent = document.getElementById('app-content');
            
            // Hentikan semua interval sebelum berpindah view
            stopSlider();
            if (countdownInterval) clearInterval(countdownInterval);

            let contentHtml = '';
            
            switch (viewName) {
                case 'home':
                    contentHtml = renderHome();
                    break;
                case 'klasemen':
                    contentHtml = renderKlasemen();
                    break;
                case 'klub':
                    contentHtml = renderKlub();
                    break;
                case 'info':
                    contentHtml = renderInfo();
                    break;
                case 'tentang':
                    contentHtml = renderTentang();
                    break;
                default:
                    contentHtml = `
                        ${renderHeader('Error')}
                        <div class="p-4 text-center text-gray-500 mt-20">Halaman tidak ditemukan.</div>
                    `;
            }

            // Render content
            appContent.innerHTML = contentHtml;

            // Update bottom navigation styling
            document.querySelectorAll('nav button').forEach(btn => {
                btn.classList.remove('nav-active', 'text-white', 'bg-blue-700', 'rounded-lg', 'shadow-inner');
                btn.classList.add('text-gray-500');
            });

            if (element) {
                element.classList.add('nav-active', 'text-white', 'bg-blue-700', 'rounded-lg', 'shadow-inner');
                element.classList.remove('text-gray-500');
            }

            // Jalankan logika khusus setelah rendering
            if (viewName === 'home') {
                startSlider();
            } else if (viewName === 'klasemen') {
                startCountdown();
            }
        }

        // Initialize the app on page load
        document.addEventListener('DOMContentLoaded', () => {
            // Ensure the initial view is 'home' and the button is active
            const homeButton = document.getElementById('nav-home');
            showView('home', homeButton);
        });

    </script>
</body>
</html>
